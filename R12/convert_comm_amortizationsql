describe DM_030_COMM_AMORTIZATION;
alter table DM_030_COMM_AMORTIZATION add R12_GL_ACCOUNT VARCHAR2(10);

update DM_030_COMM_AMORTIZATION CA set
R12_GL_ACCOUNT=(select R12_ACCOUNT from R12_TRANE_ACCOUNTS_PS PSA where PSA.PS_ACCOUNT = CA.GL_ACCOUNT)
where exists (select R12_ACCOUNT from R12_TRANE_ACCOUNTS_PS PSA where PSA.PS_ACCOUNT = CA.GL_ACCOUNT);

select * from DM_030_COMM_AMORTIZATION;

alter table DM_030_COMM_AMORTIZATION rename column GL_ACCOUNT to PS_GL_ACCOUNT;
alter table DM_030_COMM_AMORTIZATION rename column R12_GL_ACCOUNT to GL_ACCOUNT;

commit;

alter table DM_030_COMM_AMORTIZATION add R12_GL_ACCOUNT_DESCR varchar2(128);

update DM_030_COMM_AMORTIZATION CA
set R12_GL_ACCOUNT_DESCR = (select DESCR from R12_ACCOUNT_FILTER_UPD AFU where AFU.R12_ACCOUNT = CA.GL_ACCOUNT)
where exists (select DESCR from R12_ACCOUNT_FILTER_UPD AFU where AFU.R12_ACCOUNT = CA.GL_ACCOUNT);

select count(*) from DM_030_COMM_AMORTIZATION where R12_GL_ACCOUNT_DESCR is null;

alter table DM_030_COMM_AMORTIZATION rename column GL_ACCOUNT_DESCR to PS_GL_ACCOUNT_DESCR;
alter table DM_030_COMM_AMORTIZATION rename column R12_GL_ACCOUNT_DESCR to GL_ACCOUNT_DESCR;

commit;

select count(*) from DM_030_COMM_AMORTIZATION where PS_GL_ACCOUNT_DESCR <> GL_ACCOUNT_DESCR;

select distinct GL_ACCOUNT, PS_GL_ACCOUNT_DESCR, GL_ACCOUNT_DESCR from DM_030_COMM_AMORTIZATION;

-- THE FOLLOWING DOESN'T WORK:
/*
update (
	select CA.R12_GL_ACCOUNT_DESCR as NEW_DESCR, AFU.DESCR as OLD_DESCR
	from
	DM_030_COMM_AMORTIZATION CA
	inner join
	R12_ACCOUNT_FILTER_UPD AFU
	on AFU.R12_ACCOUNT = CA.GL_ACCOUNT
)
set NEW_DESCR = OLD_DESCR;
*/