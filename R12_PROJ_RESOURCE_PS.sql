-- OTR_PROJ_RESOURCE_PS
-- DR
-- synonym for AP_135_PROJ_RESOURCE
-- BUSINESS_UNIT_GL -> R12_ENTITY
-- ACCOUNT -> R12_ACCOUNT
-- DEPTID -> R12_LOCATION

CREATE TABLE "DBO"."R12_PROJ_RESOURCE_PS" (
	-- "M_ROW$$" VARCHAR2(18 BYTE), 
	"BUSINESS_UNIT" VARCHAR2(5 BYTE), -- mapSalesData1
	"PROJECT_ID" VARCHAR2(15 BYTE), -- mapSalesData1
	"ACTIVITY_ID" VARCHAR2(15 BYTE), -- mapSalesData1
	"RESOURCE_ID" VARCHAR2(40 BYTE), -- mapSalesData1
	-- "RESOURCE_ID_FROM" VARCHAR2(40 BYTE), 
	"PS_BUSINESS_UNIT_GL" VARCHAR2(5 BYTE), -- mapSalesData1
	"JOURNAL_ID" VARCHAR2(10 BYTE), -- mapSalesData1
	-- "JOURNAL_DATE" DATE, 
	-- "UNPOST_SEQ" NUMBER(*,0), 
	-- "JOURNAL_LINE" NUMBER(*,0), 
	-- "FISCAL_YEAR" NUMBER(*,0), 
	-- "ACCOUNTING_PERIOD" NUMBER(*,0), 
	"PS_ACCOUNT" VARCHAR2(10 BYTE), -- mapSalesData1
	-- "ALTACCT" VARCHAR2(10 BYTE), 
	"PS_DEPTID" VARCHAR2(10 BYTE), -- mapSalesData1
	-- "OPERATING_UNIT" VARCHAR2(8 BYTE), 
	-- "PRODUCT" VARCHAR2(6 BYTE), 
	-- "FUND_CODE" VARCHAR2(5 BYTE), 
	-- "CLASS_FLD" VARCHAR2(5 BYTE), 
	-- "PROGRAM_CODE" VARCHAR2(5 BYTE), 
	-- "BUDGET_REF" VARCHAR2(8 BYTE), 
	-- "AFFILIATE" VARCHAR2(5 BYTE), 
	-- "AFFILIATE_INTRA1" VARCHAR2(10 BYTE), 
	-- "AFFILIATE_INTRA2" VARCHAR2(10 BYTE), 
	-- "CHARTFIELD1" VARCHAR2(10 BYTE), 
	-- "CHARTFIELD2" VARCHAR2(10 BYTE), 
	-- "CHARTFIELD3" VARCHAR2(10 BYTE), 
	-- "BUS_UNIT_GL_FROM" VARCHAR2(5 BYTE), 
	"CURRENCY_CD" VARCHAR2(3 BYTE), -- mapSalesData1
	-- "STATISTICS_CODE" VARCHAR2(3 BYTE), 
	-- "LEDGER_GROUP" VARCHAR2(10 BYTE), 
	"ANALYSIS_TYPE" VARCHAR2(3 BYTE), -- mapSalesData1
	-- "RESOURCE_TYPE" VARCHAR2(5 BYTE), 
	-- "RESOURCE_CATEGORY" VARCHAR2(5 BYTE), 
	-- "RESOURCE_SUB_CAT" VARCHAR2(5 BYTE), 
	-- "RES_USER1" VARCHAR2(10 BYTE), 
	-- "RES_USER2" VARCHAR2(10 BYTE), 
	-- "RES_USER3" VARCHAR2(10 BYTE), 
	-- "RES_USER4" VARCHAR2(10 BYTE), 
	-- "RES_USER5" VARCHAR2(10 BYTE), 
	-- "TRANS_DT" DATE, 
	"ACCOUNTING_DT" DATE, -- mapSalesData1
	-- "OPRID" VARCHAR2(30 BYTE), 
	-- "DTTM_STAMP" DATE, 
	-- "JRNL_LN_REF" VARCHAR2(10 BYTE), 
	-- "OPEN_ITEM_STATUS" VARCHAR2(1 BYTE), 
	-- "LINE_DESCR" VARCHAR2(30 BYTE), 
	-- "JRNL_LINE_STATUS" VARCHAR2(1 BYTE), 
	-- "JOURNAL_LINE_DATE" DATE, 
	-- "FOREIGN_CURRENCY" VARCHAR2(3 BYTE), 
	-- "RT_TYPE" VARCHAR2(5 BYTE), 
	-- "FOREIGN_AMOUNT" NUMBER(26,3), 
	-- "RATE_MULT" NUMBER(15,8), 
	-- "RATE_DIV" NUMBER(15,8), 
	-- "CUR_EFFDT" DATE, 
	-- "PROCESS_INSTANCE" NUMBER(10,0), 
	-- "PC_DISTRIB_STATUS" VARCHAR2(1 BYTE), 
	"GL_DISTRIB_STATUS" VARCHAR2(1 BYTE), -- mapSalesData1
	-- "PROJ_TRANS_TYPE" VARCHAR2(3 BYTE), 
	-- "PROJ_TRANS_CODE" VARCHAR2(5 BYTE), 
	-- "RESOURCE_STATUS" VARCHAR2(1 BYTE), 
	"DESCR" VARCHAR2(30 BYTE), -- mapSalesData1
	-- "SYSTEM_SOURCE" VARCHAR2(3 BYTE), 
	-- "UNIT_OF_MEASURE" VARCHAR2(3 BYTE), 
	-- "EMPLID" VARCHAR2(11 BYTE), 
	-- "EMPL_RCD" NUMBER(*,0), 
	-- "SEQ_NBR" NUMBER(15,0), 
	-- "TIME_RPTG_CD" VARCHAR2(5 BYTE), 
	-- "JOBCODE" VARCHAR2(6 BYTE), 
	-- "COMPANY" VARCHAR2(3 BYTE), 
	-- "BUSINESS_UNIT_AP" VARCHAR2(5 BYTE), 
	-- "VENDOR_ID" VARCHAR2(10 BYTE), 
	-- "VOUCHER_ID" VARCHAR2(8 BYTE), 
	-- "VOUCHER_LINE_NUM" NUMBER(*,0), 
	-- "APPL_JRNL_ID" VARCHAR2(10 BYTE), 
	-- "PYMNT_CNT" NUMBER(*,0), 
	-- "DST_ACCT_TYPE" VARCHAR2(4 BYTE), 
	-- "PO_DISTRIB_STATUS" VARCHAR2(1 BYTE), 
	-- "BUSINESS_UNIT_PO" VARCHAR2(5 BYTE), 
	-- "REQ_ID" VARCHAR2(10 BYTE), 
	-- "REQ_LINE_NBR" NUMBER(*,0), 
	-- "REQ_SCHED_NBR" NUMBER(*,0), 
	-- "REQ_DISTRIB_NBR" NUMBER(*,0), 
	-- "PO_ID" VARCHAR2(10 BYTE), 
	-- "DUE_DATE" DATE, 
	-- "LINE_NBR" NUMBER(*,0), 
	-- "SCHED_NBR" NUMBER(*,0), 
	-- "DISTRIB_LINE_NUM" NUMBER(*,0), 
	-- "AM_DISTRIB_STATUS" VARCHAR2(1 BYTE), 
	-- "BUSINESS_UNIT_AM" VARCHAR2(5 BYTE), 
	-- "ASSET_ID" VARCHAR2(12 BYTE), 
	-- "PROFILE_ID" VARCHAR2(10 BYTE), 
	-- "COST_TYPE" VARCHAR2(1 BYTE), 
	-- "BOOK" VARCHAR2(10 BYTE), 
	-- "INCENTIVE_ID" VARCHAR2(10 BYTE), 
	-- "MSTONE_SEQ" NUMBER(*,0), 
	-- "CONTRACT_NUM" VARCHAR2(25 BYTE), 
	-- "CONTRACT_LINE_NUM" NUMBER(*,0), 
	-- "CONTRACT_PPD_SEQ" NUMBER(*,0), 
	-- "BI_DISTRIB_STATUS" VARCHAR2(1 BYTE), 
	-- "BUSINESS_UNIT_BI" VARCHAR2(5 BYTE), 
	-- "BILLING_DATE" DATE, 
	-- "INVOICE" VARCHAR2(22 BYTE), 
	-- "REV_DISTRIB_STATUS" VARCHAR2(1 BYTE), 
	-- "BUSINESS_UNIT_AR" VARCHAR2(5 BYTE), 
	-- "CUST_ID" VARCHAR2(15 BYTE), 
	-- "ITEM" VARCHAR2(30 BYTE), 
	-- "ITEM_LINE" NUMBER(*,0), 
	-- "ITEM_SEQ_NUM" NUMBER(*,0), 
	-- "DST_SEQ_NUM" NUMBER(*,0), 
	-- "BUSINESS_UNIT_IN" VARCHAR2(5 BYTE), 
	-- "SCHED_LINE_NO" NUMBER(6,2), 
	-- "DEMAND_LINE_NO" NUMBER(*,0), 
	-- "INV_ITEM_ID" VARCHAR2(18 BYTE), 
	-- "PAY_END_DT" DATE, 
	-- "BUSINESS_UNIT_OM" VARCHAR2(5 BYTE), 
	-- "ORDER_NO" VARCHAR2(10 BYTE), 
	-- "ORDER_INT_LINE_NO" NUMBER(*,0), 
	-- "EX_DOC_ID" VARCHAR2(10 BYTE), 
	-- "EX_DOC_TYPE" VARCHAR2(1 BYTE), 
	-- "RESOURCE_QUANTITY" NUMBER(14,2), 
	-- "RESOURCE_AMOUNT" NUMBER(26,3), 
	-- "BUDGET_HDR_STATUS" VARCHAR2(1 BYTE), 
	-- "KK_AMOUNT_TYPE" VARCHAR2(1 BYTE), 
	-- "KK_TRAN_OVER_FLAG" VARCHAR2(1 BYTE), 
	-- "KK_TRAN_OVER_OPRID" VARCHAR2(30 BYTE), 
	-- "KK_TRAN_OVER_DTTM" DATE, 
	-- "BUDGET_OVER_ALLOW" VARCHAR2(1 BYTE), 
	-- "BUDGET_LINE_STATUS" VARCHAR2(1 BYTE), 
	-- "BUDGET_DT" DATE, 
	-- "LEDGER" VARCHAR2(10 BYTE), 
	-- "BD_DISTRIB_STATUS" VARCHAR2(1 BYTE), 
	-- "BUSINESS_UNIT_BD" VARCHAR2(5 BYTE), 
	-- "FA_STATUS" VARCHAR2(1 BYTE), 
	-- "TIME_SHEET_ID" VARCHAR2(10 BYTE), 
	-- "SHEET_ID" VARCHAR2(10 BYTE), 
	-- "DT_TIMESTAMP" DATE, 
	-- "VCHR_DIST_LINE_NUM" NUMBER(*,0), 
	-- "PM_REVIEWED" VARCHAR2(1 BYTE), 
	-- "PRICED_RATE" NUMBER(26,3), 
	-- "PROJ_ID_PARM" VARCHAR2(15 BYTE)
	R12_ENTITY VARCHAR2(5 BYTE),
	R12_ACCOUNT VARCHAR2(10 BYTE),
	R12_LOCATION VARCHAR2(10 BYTE)
);

insert into R12_PROJ_RESOOURCE_PS (
	BUSINESS_UNIT,
	PROJECT_ID,
	ACTIVITY_ID,
	RESOURCE_ID,
	PS_BUSINESS_UNIT_GL,
	JOURNAL_ID,
	PS_ACCOUNT,
	PS_DEPTID,
	CURRENCY_CD,
	ANALYSIS_TYPE,
	ACCOUNTING_DT,
	GL_DISTRIB_STATUS,
	DESCR,
	R12_ENTITY,
	R12_ACCOUNT,
	R12_LOCATION
)
select
	BUSINESS_UNIT,
	PROJECT_ID,
	ACTIVITY_ID,
	RESOURCE_ID,
	BUSINESS_UNIT_GL,
	JOURNAL_ID,
	ACCOUNT,
	DEPTID,
	CURRENCY_CD,
	ANALYSIS_TYPE,
	ACCOUNTING_DT,
	GL_DISTRIB_STATUS,
	DESCR,
	DBO.F_GET_R12_ENTITY_ONLY('ENTITY', BUSINESS_UNIT_GL, ACCOUNT, DEPTID, PRODUCT, AFFILIATE) as R12_ENTITY,
	DBO.F_GET_R12_ACCOUNT_ONLY('ACCOUNT', BUSINESS_UNIT_GL, ACCOUNT, DEPTID, PRODUCT, AFFILIATE) as R12_ACCOUNT,
	DBO.F_GET_R12_LOCATION_ONLY('LOCATION', BUSINESS_UNIT_GL, ACCOUNT, DEPTID, PRODUCT, AFFILIATE) as R12_LOCATION
from 
OTR_PROJ_RESOURCE_PS;