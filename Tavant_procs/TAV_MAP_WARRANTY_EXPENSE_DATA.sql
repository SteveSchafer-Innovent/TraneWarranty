DELETE FROM MAP_WARRANTY_EXPENSE_DATA WHERE CLAIM_NUMBER < 0;
INSERT INTO MAP_WARRANTY_EXPENSE_DATA (
CLAIM_NUMBER,
STEP_NUMBER,
BUSINESS_UNIT,
RESERVE_GROUP,
CLAIM_TYPE,
EXPENSE_AMOUNT,
EXPENSE_AMOUNT_DEC,
MATERIAL_LABOR,
GL_ACCOUNT,
EXPENSE_TYPE_DESCR,
OFFICE_NAME,
GL_PROD_CODE,
MANF_PROD_CODE,
COMPANY_OWNED,
CUSTOMER_NUMBER,
CUSTOMER_NAME,
INTERNAL_EXTERNAL,
TRX_DATE,
TRX_YEAR,
TRX_MONTH,
INTMONTHS_TRX_TO_BASE,
INTMONTHS_SHIP_TO_BASE,
SHIP_DATE,
SHIP_YEAR_MONTH,
INTMONTHS_SHIP_TO_TRX,
START_DATE,
INTMONTHS_START_TO_TRX,
FAIL_DATE,
INTMONTHS_FAIL_TO_TRX,
WARRANTY_TYPE,
WARRANTY_DURATION,
CURRENCY,
COUNTRY_INDICATOR,
RETROFIT_ID,
GL_DEPT,
IN_RESERVE_PERCENT,
IN_RESERVE_PERCENT_25,
TRX_LAG,
START_LAG_25,
TRXYEARMONTH,
EXPENSE_AMT_IN_RES,
EXPENSE_AMT_NOT_IN_RES
)
SELECT
SUBSTR(STG.CLAIM_NUMBER, 3) * -1,
0 AS STEP_NUMBER,
STG.BUSINESS_UNIT,
STG.RESERVE_GROUP,
STG.CLAIM_TYPE,
STG.EXPENSE_AMOUNT,
STG.EXPENSE_AMOUNT_DEC,
STG.MATERIAL_LABOR,
STG.GL_ACCOUNT,
STG.EXPENSE_TYPE_DESCR,
STG.OFFICE_NAME,
STG.GL_PROD_CODE,
STG.MANF_PROD_CODE,
STG.COMPANY_OWNED,
STG.CUSTOMER_NUMBER,
SUBSTR(STG.CUSTOMER_NAME, 1, 34),
STG.INTERNAL_EXTERNAL,
STG.TRX_DATE,
STG.TRX_YEAR,
STG.TRX_MONTH,
STG.INTMONTHS_TRX_TO_BASE,
STG.INTMONTHS_SHIP_TO_BASE,
STG.SHIP_DATE,
STG.SHIP_YEAR_MONTH,
STG.INTMONTHS_SHIP_TO_TRX,
STG.START_DATE,
STG.INTMONTHS_START_TO_TRX,
STG.FAIL_DATE,
STG.INTMONTHS_FAIL_TO_TRX,
STG.WARRANTY_TYPE,
STG.WARRANTY_DURATION,
STG.CURRENCY,
STG.COUNTRY_INDICATOR,
STG.RETROFIT_ID,
'NA' AS GL_DEPT,
STG.IN_RESERVE_PERCENT,
STG.IN_RESERVE_PERCENT_25,
STG.TRX_LAG,
STG.START_LAG_25,
STG.TRXYEARMONTH,
STG.EXPENSE_AMT_IN_RES,
STG.EXPENSE_AMT_NOT_IN_RES
FROM TAV_STG STG
	INNER JOIN R12_ACCOUNT_FILTER_UPD AFU
		ON STG.GL_ACCOUNT = AFU.R12_ACCOUNT
WHERE 0=0
	AND AFU.STANDARD_WARRANTY_EXPENSE = 'Y'
	;
COMMIT;
